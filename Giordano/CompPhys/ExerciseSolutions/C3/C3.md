<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
</script>
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script src="../../../../Utilities.js"></script>
<script src="./C3E4.js"></script>
<script src="./C3E8.js"></script>
<script src="./C3E16.js"></script>
<script>
    // Load google charts
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(GiorCPC3E4);
    google.charts.setOnLoadCallback(GiorCPC3E8);
    google.charts.setOnLoadCallback(GiorCPC3E16);
</script>
<link rel="stylesheet" href="../../../../Styles.css">
$\require{cancel}$

<body onload="makeC3E4Graph = GiorCPC3E4();
                             makeC3E8Graph = GiorCPC3E8(); 
                             makeC3E16Graph = GiorCPC3E16(); 
">

## <center>Selected Exercise Solutions
<center>from</center>
### <center>Giordano, N. J. & Nakanishi, H. 2006. <i>Computational Physics, Second Edition.</i> 
### <center> Pearson/Prentice-Hall, Upper Saddle River, NJ.
### <center>Chapter 3: "Oscillatory Motion and Chaos"
### <center>&copy; 2025 by
### <center>David Lawrence Goldsmith
<center>for</center>
## <center>[SelectedSolutionsDotNet](https://olydlg.github.io/selectedsolutionsdotnet/)

<i>Note 1: These solutions are provided "as-is," for informational purposes only, with no warranty of any kind, expressed or implied, including that of correctness, adequacy, and/or suitability for any purpose, whatsoever.</i>&nbsp; Corrections are welcome and should be emailed to selectedsolutionsdotnet@gmail.com.

<i>Note 2: When convenient, we use the "over-dot" notation to denote ordinary differentiation, e.g., $\displaystyle \dot{x} = \frac{dx}{dt}, \ddot{x} = \frac{d^2x}{dt^2}$, etc.</i>

### _Exercise 3.4-ish_
$~~~~$Numerically solve 

$$\begin{eqnarray}
\ddot{x} & = & -x^{\alpha} \\
x(0) & = & A \\
\dot{x}(0) & = & 0  
\end{eqnarray}$$

for various positive odd integer values of $\alpha$ and the amplitude, $A$, and thereby show that the period depends on the amplitude, except for $\alpha=1$, and give an "intuitive argument" to explain the results.

### Solution

$~~~~$Below are numerical solutions for $\alpha = 1, 3, 5, 7$ with amplitudes ($A$) user-selectable from $\{0.5, 1, 1.5, 2\}$ ($A=1$ is plotted with each set for reference), and the "viewing window" is adjusted as necessary to be able to show at least one quarter-period for each solution ($\alpha=7$ when $A=0.5$ requiring the widest such window). Included in the graph’s legend is the estimated period, $T$, for each result (calculated as follows: the sign of the product $(x_n)(x_{n+1})$ is monitored and as soon as it is negative, the $t$ value,  $t_0$, for $x=0$ is linear-interpolated between $t_n$ and $t_{n+1}$; $T$ is estimated to be $4t_0$, as it does for $\alpha=1$).

$~~~~$For $\alpha = 1, 3, 5$, the second-order Runge-Kutta method (RK) presented in text Appendix A (Eqs. A.15 & A.16 and Example A.2) is used with a $\Delta t=0.01\pi$; for these $\alpha$ it performed comparably to the Euler-Cromer method using a $\Delta t = 0.001\pi$. However, for $\alpha=7$ it was found that the failure of RK to conserve energy caused the numerical solution for $A=2$ to diverge exponentially prior to $t=2\pi$. Researching the issue, we were led to an energy-conserving (under acceptable conditions) [Runge-Kutta-Nyström](https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Runge%E2%80%93Kutta%E2%80%93Nystr%C3%B6m_methods) method: given the second order autonomous (i.e., not explicitly dependent on $t$) initial value problem: $$\ddot x = f(x),~x(0)=x_0,~\dot x(0) = \upsilon_0,$$ 

the following iteration produces a fourth-order-accurate numerical solution ($h = \Delta t, \upsilon = \dot x$):

$$\begin{eqnarray}
g_i & = & x_n & + & c_i h \upsilon_n + h^2\sum_{j=1}^{i-1}a_{ij}f(g_j) \\   
x_{n+1} & = & x_n & + & h\upsilon_n + h^2\sum_{j=1}^3\bar{b}_jf(g_j) \\
\upsilon_{n+1} & = & \upsilon_n & + & h\sum_{j=1}^3b_jf(g_j) 
\end{eqnarray}
$$ where

$\displaystyle a = \left[\begin{matrix} 
0 & 0 & 0 \\ 
\frac{2-\sqrt3}{12} & 0 & 0 \\ 
0 & \frac{\sqrt3}{6} & 0  
\end{matrix}\right], 
\bar{b} = \left[\begin{matrix} 
\frac{5-3\sqrt3}{24} \\ 
\frac{3+\sqrt3}{12} \\ 
\frac{1+\sqrt3}{24}  
\end{matrix}\right],
b = \left[\begin{matrix} 
\frac{3-2\sqrt3}{12} \\ 
\frac12 \\ 
\frac{3+2\sqrt3}{12}  
\end{matrix}\right],\text{ and }
c = \left[\begin{matrix} 
\frac{3+\sqrt3}{6} \\ 
\frac{3-\sqrt3}{6} \\ 
\frac{3+\sqrt3}{6}
\end{matrix}\right]
$
([Qin & Zhu, 1991](#QinZhu))[$^1$](#Note1). Expanded, this is:
$$\begin{eqnarray}
g_1 & = & x_n + \frac{3+\sqrt3}{6}h\upsilon_n \\
g_2 & = & x_n + \frac{3-\sqrt3}{6}h\upsilon_n + \frac{2-\sqrt3}{12}h^2f(g_1) \\
g_3 & = & x_n + \frac{3+\sqrt3}{6}h\upsilon_n + \frac{\sqrt3}{6}h^2f(g_2) \\
x_{n+1} & = & x_n + h\upsilon_n + h^2\left[\frac{5-3\sqrt3}{24}f(g_1) + \frac{3+\sqrt3}{12}f(g_2) + \frac{1+\sqrt3}{24}f(g_3)\right] \\
\upsilon_{n+1} & = & \upsilon_n + h\left[\frac{3-2\sqrt3}{12}f(g_1) + \frac12 f(g_2) + \frac{3+2\sqrt3}{12}f(g_3)\right] 
\end{eqnarray}
$$
With a step size of $0.01\pi$, for $\alpha=7,~A=2$, this was found to produce a solution comparable to Euler-Cromer using $0.001\pi$.

$~~~~$As implied in the Exercise statement, the graphs and calculated $T$’s clearly show that&mdash;except for $\alpha=1$, for which $T=2\pi$ independent of the amplitude, as was to be shown&mdash;the period is inversely related (though probably not inversely proportional) to the amplitude: the larger the amplitude the shorter the period and vice-versa; also, the magnitude of this effect is directly related to $\alpha$: the larger $\alpha$ is, the greater the effect of the amplitude on the period. 

$~~~~$To understand these results intuitively, think about a mass at the end of a spring "obeying" this model: when the mass has a displacement greater than 1, for $\alpha \gt 1$, the "restoring" acceleration is relatively (much) greater (in magnitude) than it is for $\alpha=1$, and the larger $\alpha$ is, the greater will be this effect; thus for $\alpha \gt 1$, the mass will be pulled back to equilibrium relatively (much) more quickly, decreasing the time between maximum displacements (and the larger $\alpha$ is, the greater will be this effect). Conversely, when the mass has a displacement less than 1, $\alpha \gt 1$ produces a relatively (much) smaller restoring acceleration, and the mass will spend relatively (much) more time between extreme displacements, i.e., the period will be longer; and again, the larger $\alpha$ is, the greater will be this effect.

<div id="GiorCPC3E4chartTitle" style="center"></div>
<center>
  <form id="C3E4ampForm" onchange="makeC3E4Graph()">
    <label for="C3E4AmpIn">Amplitude (initial displacement, length):</label>
    <input type="number" name="C3E4AmpIn" min="0.5" max="2" step="0.5" value="1">
  </form>
</center>

<div class="chart" id="GiorCPC3E4chart" alt="Plot of Solutions to Giordano/Nakanishi Comp. Phys. Chpt. 3 Ex. 4."></div>

### _Exercise 3.8_

$~~~~$Investigate the relationship between the period and the amplitude for the non-linear pendulum:
$$\begin{eqnarray}
\ddot{\theta} & = & -\frac gl \sin \theta \\
\theta(0) & = & A \\
\dot{\theta}(0) & = & 0  
\end{eqnarray}$$
Provide an "intuitive" explanation for the results.

### Solution

$~~~~$In order to emphasize how the amplitude, $A$, impacts the period, $T$, of the solution, we take $\displaystyle \frac{g}{l} = 1$. We use the same algorithms and $\Delta t$ as in our solution to Exercise 3.4, and we enable the user to select among $A \in \{15, 30, 45, 60, 90, 120, 150, 179\}$ degrees (which are merely simpler than radians to provide in an HTML form. Reader: why haven’t we provided $A = 180$&deg; as an option? Hint: in that case, this initial value problem can be solved exactly, and the numerical solution reflects this&mdash;what is that solution?) The solutions clearly show that the period depends on the amplitude, with the period growing with amplitude (very) slowly at first, and then more rapidly as $A \rightarrow 180$&deg;. We also plot the "in-phase" cosine function with the same amplitude and period as the solution so that the reader can see how the actual shape of the solution compares to that of a pure sinusoid. This exhibits what is arguably a more interesting feature of the solutions, namely that the <i>shape</i> of the solution doesn’t deviate significantly from that of a sinusoid until $A$ is (quite) large, i.e., greater than about 150&deg;.

$~~~~$To understand both solution features, rewrite our differential equation using the Taylor series for $\sin$ in the right hand side (for convenience, we use $x$ instead of $\theta$): $$\ddot{x} = -\left(x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + ...\right) = -x + \frac{x^3}{6} - \frac{x^5}{120} + \frac{x^7}{5040} + ...$$
and "recall" our results from Exercise 3.4: those clearly showed that when $\ddot{x}$ depends on $x^{\alpha},~\alpha \in \{3, 5, 7, ...\}$, $T$ varies with $A$; however, due to the factorially-increasing denominators in the Taylor series for $\sin$, as well as the positive sign of every other coefficient (which makes those terms contribute a "reinforcing," rather than a "contra-forcing," acceleration), it takes a comparatively much larger amplitude to have a significant effect, not only on the period, but on the overall shape of the solution. In other words, yes, like the simpler case of $\ddot{x} \propto x^{\alpha},~\alpha \in \{3, 5, 7, ...\}$, the presence of terms with odd powers greater than one in the Taylor series for $\sin x$ makes the period of the solution depend on the amplitude (and makes the shape of the solution deviate from that of a pure sinusoid); but the values of the coefficients in the series significantly diminish the effect of those higher order terms until the amplitude becomes relatively much larger. 

<div id="GiorCPC3E8chartTitle" style="center"></div>
<center>
  <form id="C3E8ampForm" onchange="makeC3E8Graph()">
    <label for="C3E8AmpIn">Amplitude (initial angular displacement, degrees):</label>
    <select name="C3E8AmpIn">
      <option value="15">15</option>
      <option value="30">30</option>
      <option value="45">45</option>
      <option value="60">60</option>
      <option value="90">90</option>
      <option value="120">120</option>
      <option value="150">150</option>
      <option value="179">179</option>
    </select>
  </form>
</center>

<div class="chart" id="GiorCPC3E8chart" alt="Plot of Solutions to Giordano/Nakanishi Comp. Phys. Chpt. 3 Ex. 8."></div>

### _Exercise 3.16_

### Solution

<div id="GiorCPC3E16Title" style="center"></div>
<center><table>
  <tr style="border: none;">
    <td style="border: none;">
      <form id="C3E16FD" onchange="makeC3E16Graph()">
        <label for="C3E16FDIn">${F_D}$:</label>
        <input type="number" name="C3E16FDIn" min="1.16" max="1.24" step="0.01" value="1.2">
      </form>
    </td>
    <td style="border: none;">
      <form id="C3E16WD" onchange="makeC3E16Graph()">
        <label for="C3E16WDIn">$\Omega_D$ (units: 1/48ths):</label>
        <input type="number" name="C3E16wDIn" min="28" max="36" step="1" value="32">
      </form>
    </td>
    <td style="border: none;">
      <form id="C3E16q" onchange="makeC3E16Graph()">
        <label for="C3E16qIn">$q$:</label>
        <input type="number" name="C3E16qIn" min="0.46" max="0.54" step="0.01" value="0.5">
      </form>
    </td>
    <td style="border: none;">
      <form id="C3E16el" onchange="makeC3E16Graph()"
        <label for="C3E16elIn">$\ell$:</label>
        <input type="number" name="C3E16elIn" min="9.76" max="9.84" step="0.01" value="9.8">
      </form>
    </td>
  </tr>
</table></center>
<center><table>
  <tr style="border: none;">
    <td class="cen" style="border: none;">
      Time Domain
    </td>
    <td class="cen" style="border: none;">
      Phase Plane
    </td>
  </tr>
  <tr style="border: none;">
    <td class="cen" style="border: none; background-color: white;">
      <div class="chart" id="GiorCPC3E16tdChart" alt="Time Domain Solutions to Giordano/Nakanishi Comp. Phys. Chpt. 3 Ex. 16."></div>
    </td>
    <td class="cen" style="border: none; background-color: white;">
      <div class="chart" id="GiorCPC3E16ppChart" alt="Phase Plane Solutions to Giordano/Nakanishi Comp. Phys. Chpt. 3 Ex. 16."></div>
    </td>
  </tr>
</table></center>
### Notes

<a name="Note1" onclick="window.history.back()">1.</a> In [Qin & Zhu, 1991](#QinZhu), the summation term in the expression for $g_i$ is given as $\sum_{j=1}^{s}$, where $s$ is the number of "stages" of the method, i.e., 3 for the method we take from that source. However, as the eventual resulting matrix for $a_{ij}$ clearly shows, for each $g_i$ it is only necessary to sum to $i-1$, i.e., each $g_i$ depends only on preceding $g_i$ values. This is an inherent characteristic of this being an <i>explicit</i> (as opposed to an implicit) RK method ([Butcher, 2008](#Butcher)), and thus we feel justified, by the increased clarity, of the minor and inconsequential deviation from the primary source of expressing the sum as $\sum_{j=1}^{i-1}$.

### References

<a name="Butcher" onclick="window.history.back()">Butcher</a>, J. C., 2008, <i>Numerical Methods for Ordinary Differential Equations, Second Edition</i>, John Wiley & Sons, West Sussex, England, pg. 94.

<a name="QinZhu" onclick="window.history.back()">Qin</a>, Meng-Zhao and Wen-Jie Zhu, 1991, ["Canonical Runge-Kutta-Nyström (RKN) Methods for Second Order Ordinary Differential Equations,"](https://www.sciencedirect.com/science/article/pii/089812219190209M/pdf?md5=02fb14175fac36fd5d1961ee064420c4&pid=1-s2.0-089812219190209M-main.pdf) <i>Computers Math. Applic.</i> <b>22</b>(9) pp. 85-95.
 
### Credits
Graphs made using [Google Charts JavaScript API](https://developers.google.com/chart).

### Please Donate:
<table>
  <tr style="border: none; background: transparent;">
    <td style="border: none;">
      <b>Venmo: @David-Goldsmith-13</b>
    </td>
    <td style="border: none;">
      <form action="https://www.paypal.com/cgi-bin/webscr"
            method="post"><input name="cmd"
            value="_xclick" type="hidden"> <input name="business"
            value="dgoldsmith_89@alumni.brown.edu" type="hidden"> <input
            name="item_name" value="SelectedSolutions Donation"
            type="hidden"> <input name="cn" value="Special Instructions
            (optional" type="hidden"> <input
            src="https://www.paypal.com/images/x-click-but04.gif"
            name="submit" alt="Make payments with PayPal - it's fast,
            free and secure!" align="middle" border="0" type="image"></form>
    </td>
  </tr>
</table>
